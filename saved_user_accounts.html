<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Manage User Accounts</title>
	<style>
		:root {
			--bg: #0f172a;
			--card: #111827;
			--text: #e5e7eb;
			--muted: #94a3b8;
			--accent: #38bdf8;
			--danger: #ef4444;
			--success: #22c55e;
			--shadow: 0 10px 40px rgba(0,0,0,0.35);
			--radius: 16px;
		}

		* { box-sizing: border-box; }
		body {
			margin: 0;
			min-height: 100vh;
			font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Segoe UI Emoji", "Segoe UI Symbol";
			background: radial-gradient(1200px 600px at 15% 0%, #0b122a 0%, var(--bg) 60%, #0a1023 100%);
			color: var(--text);
			padding: 32px 16px 64px;
			display: flex;
			justify-content: center;
		}

		main {
			width: min(960px, 100%);
			display: grid;
			gap: 24px;
		}

		header {
			display: flex;
			flex-wrap: wrap;
			justify-content: space-between;
			align-items: center;
			gap: 16px;
		}

		h1 {
			margin: 0;
			font-size: 1.8rem;
			letter-spacing: 0.2px;
		}

		.subtitle {
			color: var(--muted);
			margin-top: 6px;
			font-size: 0.95rem;
		}

		.btn {
			border: none;
			border-radius: 999px;
			padding: 12px 20px;
			font-weight: 600;
			cursor: pointer;
			box-shadow: 0 8px 20px rgba(56, 189, 248, 0.35);
			background: var(--accent);
			color: #062a3a;
		}

		.btn.secondary {
			background: transparent;
			border: 1px solid #1f2937;
			color: var(--text);
			box-shadow: none;
		}

		.btn.danger {
			background: var(--danger);
			color: #fff;
			box-shadow: 0 8px 20px rgba(239, 68, 68, 0.35);
			border: none;
			padding: 8px 16px;
		}

		.panel {
			background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01)), var(--card);
			border: 1px solid #1f2937;
			border-radius: var(--radius);
			box-shadow: var(--shadow);
			padding: 24px;
		}

		form {
			display: grid;
			gap: 14px;
		}

		label {
			font-size: 0.9rem;
			color: var(--muted);
		}

		input[type="text"],
		input[type="password"] {
			width: 100%;
			padding: 12px;
			border-radius: 10px;
			border: 1px solid #1f2937;
			background: rgba(15, 23, 42, 0.9);
			color: var(--text);
			font-size: 1rem;
		}

		.feedback {
			min-height: 20px;
			font-size: 0.95rem;
			font-weight: 600;
		}

		.feedback.error { color: var(--danger); }
		.feedback.success { color: var(--success); }

		.accounts-list {
			list-style: none;
			margin: 0;
			padding: 0;
			display: grid;
			gap: 12px;
		}

		.account-item {
			border: 1px solid #1f2937;
			border-radius: 14px;
			padding: 14px 16px;
			background: rgba(15, 23, 42, 0.85);
			display: flex;
			justify-content: space-between;
			align-items: center;
			flex-wrap: wrap;
			gap: 10px;
		}

		.account-name {
			margin: 0;
			font-size: 1.05rem;
			font-weight: 600;
		}

		.account-note {
			margin: 2px 0 0;
			color: var(--muted);
			font-size: 0.85rem;
		}

		.badge {
			padding: 6px 12px;
			border-radius: 999px;
			border: 1px solid #1f2937;
			background: rgba(56, 189, 248, 0.12);
			color: var(--accent);
			font-size: 0.8rem;
			letter-spacing: 0.3px;
		}

		@media (max-width: 600px) {
			.btn {
				width: 100%;
			}
		}
	</style>
</head>
<body>
	<main>
		<header>
			<div>
				<h1>Saved User Accounts</h1>
				<p class="subtitle">Create unique credentials that can sign in to the Project Dashboard.</p>
			</div>
			<button class="btn secondary" id="backToDashboard">Return to Dashboard</button>
		</header>

		<section class="panel" aria-label="Add user account">
			<form id="accountForm" autocomplete="off">
				<div>
					<label for="newUsername">Username</label>
					<input type="text" id="newUsername" placeholder="Enter a unique username" required />
				</div>
				<div>
					<label for="newPassword">Password</label>
					<input type="password" id="newPassword" placeholder="Create a password" required />
				</div>
				<button class="btn" type="submit">Save Account</button>
				<div class="feedback" id="accountFeedback" aria-live="polite"></div>
			</form>
		</section>

		<section class="panel" aria-label="Existing accounts">
			<h2 style="margin-top:0">Existing Accounts</h2>
			<ul class="accounts-list" id="accountsList"></ul>
		</section>
	</main>

	<script>
		(function () {
			const USERS_KEY = 'projectDashboardAccounts';
			const DEFAULT_ACCOUNT = { username: 'Admin', password: 'T0ms1234', system: true };

			const escapeHtml = (value = '') => String(value).replace(/[&<>"']/g, (char) => ({
				'&': '&amp;',
				'<': '&lt;',
				'>': '&gt;',
				'"': '&quot;',
				"'": '&#39;'
			}[char] || char));

			const loadAccounts = () => {
				try {
					const raw = window.localStorage && window.localStorage.getItem(USERS_KEY);
					const parsed = raw ? JSON.parse(raw) : [];
					return Array.isArray(parsed) ? parsed : [];
				} catch (error) {
					return [];
				}
			};

			const saveAccounts = (accounts) => {
				try {
					window.localStorage && window.localStorage.setItem(USERS_KEY, JSON.stringify(accounts));
				} catch (error) {
					// ignore storage failures
				}
			};

			const ensureDefaultAccount = (accounts) => {
				const exists = accounts.some((account) => account.username && account.username.toLowerCase() === DEFAULT_ACCOUNT.username.toLowerCase());
				if (!exists) {
					accounts.unshift({ username: DEFAULT_ACCOUNT.username, password: DEFAULT_ACCOUNT.password, system: true });
				}
				return accounts;
			};

			let accounts = ensureDefaultAccount(loadAccounts());
			saveAccounts(accounts);

			const listEl = document.getElementById('accountsList');
			const form = document.getElementById('accountForm');
			const feedbackEl = document.getElementById('accountFeedback');
			const backBtn = document.getElementById('backToDashboard');

			const renderAccounts = () => {
				if (!listEl) { return; }
				if (!accounts.length) {
					listEl.innerHTML = '<li class="account-item"><p class="account-name">No accounts saved yet.</p></li>';
					return;
				}
				listEl.innerHTML = accounts.map((account) => {
					const note = account.system ? 'Default administrator credentials' : 'Created via this page';
					const safeName = escapeHtml(account.username || '');
					const action = account.system
						? '<span class="badge">Default</span>'
						: `<button class="btn danger" type="button" data-delete="${encodeURIComponent(account.username)}">Delete</button>`;
					return `
						<li class="account-item">
							<div>
								<p class="account-name">${safeName}</p>
								<p class="account-note">${note}</p>
							</div>
							${action}
						</li>
					`;
				}).join('');
			};

			const setFeedback = (message, type) => {
				if (!feedbackEl) { return; }
				feedbackEl.textContent = message;
				feedbackEl.classList.remove('error', 'success');
				if (type) {
					feedbackEl.classList.add(type);
				}
			};

			const usernameExists = (username) => {
				return accounts.some((account) => account.username && account.username.toLowerCase() === username.toLowerCase());
			};

			if (form) {
				form.addEventListener('submit', (event) => {
					event.preventDefault();
					const usernameInput = document.getElementById('newUsername');
					const passwordInput = document.getElementById('newPassword');
					const username = usernameInput?.value.trim() || '';
					const password = passwordInput?.value || '';

					if (!username || !password) {
						setFeedback('Provide both a username and password.', 'error');
						return;
					}

					if (usernameExists(username)) {
						setFeedback('That username already exists. Choose another.', 'error');
						return;
					}

					accounts.push({ username, password });
					saveAccounts(accounts);
					renderAccounts();
					setFeedback(`User "${username}" saved successfully.`, 'success');
					if (usernameInput) { usernameInput.value = ''; }
					if (passwordInput) { passwordInput.value = ''; }
				});
			}

			if (listEl) {
				listEl.addEventListener('click', (event) => {
					const button = event.target.closest('[data-delete]');
					if (!button) { return; }
					const encoded = button.getAttribute('data-delete');
					const username = encoded ? decodeURIComponent(encoded) : '';
					if (!username) { return; }
					const target = username.toLowerCase();
					accounts = accounts.filter((account) => (account.username || '').toLowerCase() !== target);
					accounts = ensureDefaultAccount(accounts);
					saveAccounts(accounts);
					renderAccounts();
					setFeedback(`User "${username}" was removed.`, 'success');
				});
			}

			if (backBtn) {
				backBtn.addEventListener('click', () => {
					window.location.href = 'index.html';
				});
			}

			renderAccounts();
		})();
	</script>
</body>
</html>
